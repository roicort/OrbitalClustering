\RestyleAlgo{ruled}
\SetKwComment{Comment}{/* }{ */}


\begin{algorithm}[hbt!]
\caption{Pseudocódigo $Mini Batch KMeans$ \cite{sculley_web-scale_2010}} \label{algorithms:minibatchk-means}
\KwIn{Puntos $X = \{x_1,x_2...x_n\}$, Cantidad de grupos $K$, Tamaño del MiniBatch $b$, iteraciones $t$}
\KwOut{$K$ Grupos $C = \{c_1,c_2...c_k\}$}
Inicializar $K$ centroides y $K$ Grupos\; 
$N_{C_i}$ Inicializar el número de muestra para cada grupo\; 

\For{j en rango t}{
    Definir M que es el batch con $b$ ejemplos aleatorios de X\;
    \For{$m$ en rango $b$}{
        $C_i(x_m) = \frac{1}{|C_i|}\sum{x_m}$ \Comment*[r]{Calcular centroide} 
    }
    \For{$m$ en rango $b$}{

        $c_i = C_i(x_m)$ \Comment*[r]{Obtener centroide} 

        $N_{C_i} = N_{C_i} + 1$ \Comment*[r]{Actualizar el número de muestra} 
        
        $lr=1/N_{C_i}$ \Comment*[r]{Calcular taza de aprendizaje} 

        $C_i = (1-lr)c_i + lr*x_m$ \Comment*[r]{Utilizar la taza de aprendizaje para actualizar el centroide} 
    }      
}
\end{algorithm}